---
title: "Assignment 2"
author: "Gracie White and Chase Brewster"
date: "4/25/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, echo=FALSE}
library(tidyverse)
library(scales)


gas <- read_csv("Gas_Data.csv")

```
This homework asks you to examine the possible distributional effects of a (mostly real)
proposal to raise the gas tax in France. The overall questions are: (1) What will be the
distributional effects of the tax increase? (2) How much revenue will be generated for
infrastructure repairs? (3) By how much will environmental damage be reduced and who
will benefit? (4) What is the role of electric vehicle demand?

1. Consumers can be separated into two income groups: “High” and “Low”. The
data set provides price (in $) and quantity (in gallons) estimates of demand per
day for the two groups. Run regressions to estimate the demand curves for “High”
and “Low” income consumers.
2. Initially, there is no gas tax.
3. The current gas price (without any taxes) is $5.00/gal.
4. The marginal cost of producing a gallon of gasoline is linear and has priceintercept of 0. For the purposes of this exercise, you can assume that France is
self-contained in supply and demand (you don’t need to worry about global
markets).
5. Consuming each gallon of gasoline creates an environmental and health
externality in France of approximately $2.00.


Your assignment is to walk through the following analyses and then draft a memo to
President Macron advising him on the answers to the three questions posed at the top of
this page. You can include a technical appendix with responses to these questions.

1. What is the aggregate daily demand curve for gasoline in France? What is the
supply curve for gasoline? What is the “benefit” to consumers under the status
quo? What is the “benefit” to producers under the status quo? What is the
environmental cost under the status quo?

```{r}
#problem 1: 

#ok so first creating 2 linear models for each income group. 

high_lm <- lm(Price_Dollars ~ Q_High_Gallons_per_Day, data = gas)
high_lm

high_intercept <- 23.3914418
high_slope <- -0.0001297

#high price = 23.3914418 + -0.0001297(Q)


low_lm <- lm(Price_Dollars ~ Q_Low_Gallons_per_Day, data = gas)
low_lm

low_intercept = 21.9908534
low_slope = -0.0001355

#low price = 21.9908534 + -0.0001355(Q)

#aggregate price, solved both equations for q, then added 

# DEMAND CURVE


Qag_intercept <- 22.70642416
Qag_slope <- -0.000066268

#Demand Curve Plot
eq.1 <- function(x){22.70642416 - 0.000066268*x}
plot(eq(0:35000), type = 'l')


#Supply Curve

# supply cost = 5(q)

sup_eq <- function(x){0.000018713*x}
plot(sup_eq(0:35000), type = 'l')


high_demand <- function(x){23.3914418 + -0.0001297*x}

income_groups_plot <- ggplot(gas, aes(y = Price_Dollars)) +
  geom_line(aes(x = Q_High_Gallons_per_Day), color = "red") +
  geom_line(aes(x = Q_Low_Gallons_per_Day))

income_groups_plot


funtion_plot <- ggplot(data = data.frame(x=0),mapping = aes(x = x)) +
  stat_function(fun = eq.1, aes(color = "Demand")) +
  stat_function(fun = sup_eq, aes(color = "Supply")) + 
  xlim(-1, 350000) +
  theme_bw() +
  scale_colour_manual("Curves", values = c("red", "blue")) +
  labs(title = "Status Quo: Supply and Demand", y = "Price", x = "Gallons of Gasoline")
 
  
funtion_plot
ggsave("statusquo.png")


#Free market Eq
# Q = 267194.1836
# slope = 0.000018713

#supply curve = 0.000018713(Q)

#consumer benefit: 2369230.221

#producer surplus: 667985.34

#environmental cost: 534388.272

#HCB = $1303951.933
#LCB = 1065273.429


```
2. How the benefit is split


3. Tax stuff
A gas tax of $0.50/gal. is proposed. What would be the effects of this tax on:
a. The amount of gasoline produced and sold in France.

Q = 261310.4595 gallon of gas

b. The price of gasoline.

P = $5.3899026 dollars/gallon 

producrers recieve $4.889/gallon

c. Welfare of “High” income consumers.
$1,249,249



d. Welfare of “Low” income consumers.

$1,016,943

e. Welfare of gas producers.
$638,773.418

f. Total environmental damage.

$522,620.919
g. Total revenue generated by the tax

$130,655.2297

```{r}

fun_tax <- function(x){0.000018713*x + 0.5}

fun_msc <- function(x){}


tax_plot <- ggplot(data = data.frame(x=0),mapping = aes(x = x)) +
  stat_function(fun = eq.1, aes(color = "Demand")) +
  stat_function(fun = fun_tax, aes(color = "Supply")) + 
  xlim(-1, 350000) +
  theme_bw() +
  scale_colour_manual("Curves", values = c("red", "blue")) +
  labs(title = "$0.50 Gas Tax: Supply and Demand", y = "Price", x = "Gallons of Gasoline")
tax_plot
ggsave("tax.png")


  
```
4. in excel


5. 
Finally, assume that electric cars will gain popularity and that in the future this
will lower the demand curves of all income groups by half (vertically). Under
these new demand curves, what are the effects on:
a. Gas consumption by “High” income consumers
78,805.2 gallons

b. Gas consumption by “Low” income consumers
71,300.3 gallons

c. Gas price
aggregate demand = 11.35319611 - 0.000066268Q
q = 133597
p = 2.5

d. Environmental damage from gasoline
$267,194



6. Using these numbers, which has a bigger impact on environmental quality, a
$2.00/gal. gas tax or the invention of electric cars? Provide your evidence.

The invention of electric cars wil have a much greater impact on environmental quality, 

2 dollar tax: $487,221.45
Electric cars: $267,194
